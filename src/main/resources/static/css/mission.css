html, body {
  height: 100%;
}
body {
  margin: 0;
  font-family: sans-serif;
  display: grid;
  place-items: center;
  background: #111;
  overflow: hidden;
}

/* 背景桌面 */
.stage {
  position: relative;
  width: min(96vw, 1200px);
  aspect-ratio: 3 / 2;
  background: url('/images/mission.png') center/cover no-repeat;
  border-radius: 8px;
  overflow: hidden;
}

/* —— 中央置中容器 —— */
.center-panel {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-55%, -49%);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: clamp(18px, 2.2vw, 28px);
}

/* 卡片群組 */
.btn-group {
  display: flex;
  align-items: center;
  gap: clamp(12px, 2.2vw, 28px);
}
#fail-btn,
#success-btn {
  display: inline-block;   /* 新增這行 */
  width: clamp(190px, 20vw, 320px);
  aspect-ratio: 270 / 390;
  background-position: center;
  background-repeat: no-repeat;
  background-size: contain;
  border: none;
  outline: none;
  transition: transform 0.18s ease;
  cursor: pointer;         /* 確保滑鼠會變手指 */
}

#fail-btn    { background-image: url("/images/card-failure.png"); }
#success-btn { background-image: url("/images/card-successful.png"); }

button { background: none; color: inherit; cursor: pointer; border: none; }
button:hover:not(:disabled),
button.selected { transform: scale(1.06) translateY(-4px); }
button:disabled { opacity: .5; cursor: default; }

#confirm-btn {
  padding: 10px 24px;
  font-size: clamp(14px, 1.6vw, 18px);
  border-radius: 8px;
  border: 2px solid #3a2c12;
  background-color: #8b5a2b;
  color: #fffaf0;
  font-weight: bold;
  transition: transform .2s ease, background-color .3s ease;
}
#confirm-btn:hover:not(:disabled) {
  transform: scale(1.05);
  background-color: #a0522d;
}

.hidden { display: none; }

/* ===== 等待畫面（動圖靠左、紙條靠右） ===== */
.waiting-layer {
  position: absolute;
  inset: 0;
  display: flex;
  justify-content: center;
  align-items: center;
}

/* 橫排：左動圖｜右紙條 */
.waiting-stack {
  display: flex;
  flex-direction: row;
  align-items: flex-start;
  gap: clamp(18px, 4vw, 36px);
  transform: translate(-3%, -6%);
}

/* 動圖 */
.role-anim {
  width: clamp(220px, 18vw, 260px);
  height: auto;
  display: block;
}

/* ===== 紙條（可單獨移動） ===== */
.paper-note {
  --tx: -60px;  /* 往左移多少 */
  --ty: 70px;   /* 往下移多少 */

  position: relative;
  width: clamp(240px, 22vw, 320px);
  padding: 14px 16px;
  background: #f7f1d3;
  border: 2px solid #3a2c12;
  border-radius: 6px;
  box-shadow: 0 8px 18px rgba(0,0,0,.3);
  transform: translate(var(--tx), var(--ty)) rotate(-1.2deg);
  transition: opacity .25s ease, transform .25s ease;
  cursor: pointer;
  z-index: 1;
}
.paper-note.hidden {
  opacity: 0;
  pointer-events: none;
  transform: translate(var(--tx), calc(var(--ty) + 6px)) rotate(-1.2deg);
}
.paper-note.show {
  opacity: 1;
  pointer-events: auto;
  transform: translate(var(--tx), var(--ty)) rotate(-1.2deg);
}

.paper-pin {
  position: absolute;
  width: 14px; height: 14px;
  background: #7b0f0f;
  border-radius: 50%;
  top: -8px; left: 50%;
  transform: translateX(-50%);
  box-shadow: 0 3px 0 #3a2c12;
}
.paper-content {
  color: #3a2c12;
  line-height: 1.5;
  font-size: 14px;
}

/* ===== 各職業動畫 ===== */

/* 工程師 21–24 */
@keyframes engineerFrames {
  0%   { content: url("/images/21.png"); }
  25%  { content: url("/images/22.png"); }
  50%  { content: url("/images/23.png"); }
  75%  { content: url("/images/24.png"); }
  100% { content: url("/images/23.png"); }
}
.role-anim[data-role="engineer"] {
  animation: engineerFrames 1s steps(1) infinite;
}

/* 醫護兵 31–34 */
@keyframes medicFrames {
  0%   { content: url("/images/31.png"); }
  25%  { content: url("/images/32.png"); }
  50%  { content: url("/images/33.png"); }
  75%  { content: url("/images/34.png"); }
  100% { content: url("/images/33.png"); }
}
.role-anim[data-role="medic"] {
  animation: medicFrames 1s steps(1) infinite;
}

/* 指揮官 41–44 */
@keyframes commanderFrames {
  0%   { content: url("/images/41.png"); }
  25%  { content: url("/images/42.png"); }
  50%  { content: url("/images/43.png"); }
  75%  { content: url("/images/44.png"); }
  100% { content: url("/images/43.png"); }
}
.role-anim[data-role="commander"] {
  animation: commanderFrames 1s steps(1) infinite;
}

/* 普通倖存者 51–53 */
@keyframes civilianGoodFrames {
  0%   { content: url("/images/51.png"); }
  33%  { content: url("/images/52.png"); }
  66%  { content: url("/images/53.png"); }
  100% { content: url("/images/52.png"); }
}
.role-anim[data-role="civilian-good"] {
  animation: civilianGoodFrames 1s steps(1) infinite;
}

/* 破壞者 61–62 */
@keyframes saboteurFrames {
  0%   { content: url("/images/61.png"); }
  50%  { content: url("/images/62.png"); }
  100% { content: url("/images/61.png"); }
}
.role-anim[data-role="saboteur"] {
  animation: saboteurFrames 0.8s steps(1) infinite;
}

/* 邪惡平民 71–72 */
@keyframes civilianBadFrames {
  0%   { content: url("/images/71.png"); }
  50%  { content: url("/images/72.png"); }
  100% { content: url("/images/71.png"); }
}
.role-anim[data-role="civilian-bad"] {
  animation: civilianBadFrames 0.8s steps(1) infinite;
}

/* 影武者 81–82 */
@keyframes shadowFrames {
  0%   { content: url("/images/81.png"); }
  50%  { content: url("/images/82.png"); }
  100% { content: url("/images/81.png"); }
}
.role-anim[data-role="shadow"] {
  animation: shadowFrames 0.8s steps(1) infinite;
}

/* 潛伏者 11–14 */
@keyframes lurkerFrames {
  0%     { content: url("/images/11.png"); }
  16.6%  { content: url("/images/12.png"); }
  33.3%  { content: url("/images/13.png"); }
  50%    { content: url("/images/14.png"); }
  66.6%  { content: url("/images/13.png"); }
  83.3%  { content: url("/images/12.png"); }
  100%   { content: url("/images/11.png"); }
}
.role-anim[data-role="lurker"] {
  animation: lurkerFrames 0.8s steps(1) infinite;
}

/* ===== RWD：小螢幕自動改直排 ===== */
@media (max-width: 900px) {
  .waiting-stack {
    flex-direction: column;
    transform: none;
    gap: 12px;
  }
  .role-anim { width: clamp(160px, 28vw, 200px); }
  .paper-note { 
    width: clamp(240px, 80vw, 320px);
    --tx: 0px;  /* 手機上紙條回正 */
    --ty: 0px;
  }
}
/* 讓任務選擇層鋪滿舞台並壓在最上層 */
#mission-choice-panel {
  position: absolute;
  inset: 0;
  z-index: 20;            /* 高於等待層 */
  pointer-events: auto;
}

/* 等待層放低一點，避免誤遮擋 */
.waiting-layer {
  position: absolute;
  inset: 0;
  z-index: 10;
}

/* 中央容器也確保在上層、可點 */
.center-panel {
  position: absolute;     /* 你原本就有；這裡重申以確保 */
  z-index: 21;
  pointer-events: auto;
}

/* 卡片按鈕一定要有可點擊的盒模型，避免被視為零尺寸或不吃事件 */
#fail-btn,
#success-btn {
  display: inline-block;  /* 關鍵：確保是盒子 */
  width: clamp(190px, 20vw, 320px);
  aspect-ratio: 270 / 390;
  background-position: center;
  background-repeat: no-repeat;
  background-size: contain;
  border: none;
  outline: none;
  transition: transform 0.18s ease;
  cursor: pointer;        /* 滑鼠手指 */
  pointer-events: auto;   /* 不讓上層樣式關掉事件 */
}

/* 保險：被隱藏時徹底不吃事件 */
.hidden { 
  display: none !important;
  pointer-events: none !important;
}
/* 讓等待動圖看起來可點 */
.role-anim {
  cursor: pointer;
  user-select: none;
  touch-action: manipulation;
}
